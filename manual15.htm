<html><body>
<h3>[15] Visualizador 3D (Cave3D)</h3>

<p>O Visualizador 3D do TopoDroid foi criado para ser utilizado dentro da caverna não dependendo de conexão com a internet.</p>

<p>Ele pode também carregar outros formatos de arquivo:Therion (th, thconfig), Loch (lox), Compass (dat, mak), Survex (3d) e VisualTopo (tro, trox). </p>

<p>O modelo 3D pode ser aberto tanto a partir da opção de menu <u>3D</u> na tela <i>Dados da topo</i> quanto a partir da tela <i>Info topo</i>.</p>

<p>O modelo 3D de um projeto pode ser aberto a partir do botão correspondente na tela <i>Projeto</i>.</p>

<p>O modelo é apresentado com uma grade (azul norte e verde oeste) ou conjunto de três eixos (rosa para cima) de referência.</p>

<p>Se os dados (topo ou projeto) contar com pontos fixos (com coordenadas geográficas), estes serão usados para calcular as coordenadas dos pontos do modelo.
Se as coordenadas tiverem sido definidas em um sistema cartográfico (projetado), este será usado.
Do contrário os pontos fixos serão posicionados considerando as distâncias do equador e do meridiano de referência com a latitude multiplicada pelo raio do meridiano e a longitude multiplicada pelo raio do círculo paralelo respectivamente.</p>

<p>As coordenadas em sistema cartográficos de referência não levam em consideração a convergência dos meridianos.
Dessa maneira o norte não é o norte cartográfico mas sim a direção do meridiano.</p>

<p>Não é realizada nenhuma conversão de coordenadas.
Assim, todas as topos em um mesmo projeto devem estar referênciadas em um mesmo sistema de coordenadas.</p>

<h4>BOTÕES</h4>

<ul>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_turn.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_move.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_light.png"> <i>Modo</i>: rodar o modelo ou mover o modelo ou a fonte de luz (se houver um DEM definido).
Clicando com dois dedos simultaneamente é possível dar zoom ou mover o modelo.</li>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_orthogonal.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_perspective.png"> <i>Visualização</i>: ou ortográfica ou em perspectiva.</li>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_station_no_dot.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_station_point_dot.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_station_name_dot.png"> <i>Bases</i>: ocultar, mostrar com ponto, mostrar com nome.</li>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_splays_none.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_splays_line.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_splays_point.png"> <i>Medidas auxiliares</i>: ocultar, mostrar como linhas ou como pontos.</li>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_wall_no.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_wall.png"> <i>Paredes</i>: ocultar ou mostrar (se tiverem sido criadas).</li>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_surface_off.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_surface_on.png"> <i>Superfície</i>: ocultar ou mostrar superfície DEM (se disponível).</li>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_color.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_color_survey.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_color_depth.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_color_surface.png"> <i>Cor</i>: cor da linha de trena: branca, por topo, por profundidade ou superfície.</li>
<li><img style="border:1px solid black" width="36" height="36" src="btn_3d_frame_grid.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_frame_axes.png"><img style="border:1px solid black" width="36" height="36" src="btn_3d_frame_no.png"> <i>Grade</i>: grade XY, eixos XYZ ou nenhuma.</li>
</ul>

<p>Os ícones dos botões são alterados para indicar a seleção atual.</p>

<p>Alguns botões tem ações disparadas por cliquers longos:</p>

<ul>
<li><i>Visualização</i>: ajusta a distância focal da perspectiva.</li>
<li><i>Bases</i>: liga e desliga a possibilidade de selecionar bases.</li>
<li><i>Cor</i>: seleciona as topos a serem apresentadas e ocultadas.</li>
<li><i>Grade</i>: abre a caixa de diálogo <i>Visadas visíveis</i> (apresentação de visadas de superfície, duplicadas e comentadas).</li>
</ul>

<h4>MENU</h4>

<ul>
<li><i>Abrir</i>: abrir um arquivo de topo do diretório de trabalho.</li>
<li><i>Exportar</i>: abre a caixa de diálogo <i>Exportar modelo 3D</i>.</li>
<li><i>Info</i>: informações estatísticas do modelo.</li>
<li><i>Diagrama Ico</i>: distribuição de direções 3D.</li>
<li><i>Diagrama Rose</i>: distribuição dos azimutes.</li>
<li><i>Reiniciar</i>: retornar para visualização ortogonal de cima, com zoom 1.</li>
<li><i>Ponto de vista</i>: alterar o ponto de vista: topo, leste, norte, oeste, sul.
Por exemplo "sul" quer dizer olhar para a caverna a partir do sul.</li>
<li><i>Superfície</i>: arquivo DEM e sua transparência.
Projecão da linha de trena na superfície.</li>
<li><i>Paredes</i>: criar ou limpar a reconstrução 3D de paredes.
Liga e desliga as projeções das paredes na planta baixa e no perfil.</li>
<li><i>Configurações</i></li>
<li><i>Ajuda</i></li>
</ul>

<h4>CONFIGURAÇÕES</h4>

<ul>
<li><i>Diretório trabalho</i>: diretório com as topos.</li>
<li>
    <u>Visualizador 3D</u>:
    <ul>
        <li><i>Visão abaixo horizonte</i>: permitir pontos de vista abaixo do horizonte [padrão não].</li>
        <li><i>Ponto base</i>: sempre mostrar pontos (verdes) representando bases [padrão não].</li>
        <li><i>Raio ponto base</i>: raio dos pontos das bases [8 pxl].</li>
        <li><i>Tam nome base</i>: tamanhos dos nomes das bases [20 pt].</li>
        <li><i>Raio seleção</i>: raio da ferramenta de seleção [1.0]</li>
        <li><i>Mensagem distância</i>: usar mensagem no lugar de caixa de diálogo para distância [padrão não]</li>
        <li><i>Caixa Diálogo base</i>: usar caixa de diálogo no lugar de caixa de edição [padrão não].</li>
        <li><i>Grade topo</i>: apresentar grade no topo [padrão não].</li>
        <li><i>Extensão grade</i>: tamanho da extensão da grade ao redor da planta baixa [10 células].</li>
        <li>
            <u>DEM</u>:
            <ul>
                <li><i>Buffer DEM</i>: extensão do modelo de superfície DEM ao redor da topo a ser carregada do arquivo DEM.</li>
                <li><i>Tam máx DEM</i>: Tamanho máximo da superfície DEM em cada direção [padrão 400 células].</li>
                <li><i>Redução DEM</i>: Modo de redução DEM (subamostragem ou cortar) [padrão subamostragem].</li>
            </ul>
        </li>
        <li>
            <u>MODELAGEM PAREDES</u>:
            <ul>
                <li><i>Uso aux</i>: quais medidas auxiliares usar: nenhum, normal, corte [padrão normal]</li>
                <li><i>Todas aux</i>: usar todas as medidas auxiliares na modelagem de paredes [padrão não]</li>
                <li><i>Aux projetada</i>: projetar as medidas auxiliares em um plano normal [padrão não]</li>
                <li><i>Lim aux</i>: medidas auxiliares fora da visada a manter [0.5]</li>
                <li><i>Partir triângulos</i>: partir triângulos de paredes que se interceptarem [padrão sim]</li>
                <li><i>Ruído pontos</i>: pequeno vetor aleatório adicionado às medidas auxiliares ao modelar paredes [padrão 0.1]</li>
                <li><i>Alongar paredes</i>: distância a alongar pontos das paredes na direção da visada [padrão 0.1]</li>
                <li><i>Delta Powercrust</i>: parâmetro "delta" do algoritmo powercrust [padrão 0.1]</li>
            </ul>
        </li>
    </ul>
</li>
</ul>

<b>TITLE LINE</b><br>
The title bar shows the viewing parameters:
<ul>
<li><i>C</i> and <i>A</i> clino and azimuth of the viewpoint.</li>
<li><i>S</i> is the zoom factor.</li>
<li><i>T</i> are the X-Y translations of the model.</li>
<li><i>L</i> are the clino and azimuth of the light.</li>
</ul>
<br><p>

<b>EXPORTS</b><br>
Model can be exported as DXF, KML, STL or STL-binary, CGAL, LAS-binary, and shapefile.<br>
The exported file is saved in the folder "c3export" of the current working directory.
<br><p>

There are options to include splays, walls, stations and surface in export.<br>
The model can be also serialized in a text file.
<br><p>

<b>GRID/FRAME</b><br>
The grid/frame lines are green (west-east), blue (south-north), and red (vertical).<br>
In perspective the grid looks greenish to the north/south because the green lines stack together closer.
And it looks blueish to the west/east.
To help distinguish the for cardinal directions, the grid gets slightly reddish at the west-south corner.<br>
By default the grid is below the survey, but it can be set above it (optionally).
<br><p>

<b>SURVEY</b><br>
The survey splays can be hidden, displayed as lines or endpoints.<br>
The survey legs can be uncolored or colored by survey, by depth (red-to-blue) or by
the depth beneath the surface (blue-to-red) if the model has a DEM surface.<br>

When uncolored the survey legs are white, the surface legs green, the duplicate legs orange, 
and the commented legs light blue.<br>

The "surface", "duplicate", and "commented" legs can be turned on/off with the <i>leg dialog</i> which
is opened by a long-tap on the fourth button.
<br><p>

<b>WALLS</b><br>
The wall model is not computed automatically when the file is opened, but it must be
requested by the user through the "wall" menu.
There are three models: <i>simple hull</i>, <i>pseudo convex-hull</i>, and <i>powercrust</i>.
The first two are suitable when the splay are not dense. The third one is for dense splays.<br>

The wall model depends on the number and the quality of the splays.
Poor splays will result in a poor model.<br>

The computation is done in background.
When done the wall can be displayed with the "wall" button.<br><p>

The powercrust model includes also the projection of the walls on the horizontal plane (plan view), and on a vertical curtain
along the survey (profile view). Their display is enabled through the "walls" menu.
<br><p>

<b>SURFACE</b><br>
If the (Therion or Loch) model contains surface data (Digital Elevation Model), the surface can be displayed either gray or
with the texture (if available).<br>
The surface dialog has a button to load a DEM from a file. The supported formats are ascii (.asc or .ascii) and Therion grid (.grid). 
Only the relevant portion of the DEM file is loaded.<br>
The survey and the DEM data file must be in the same (cartographic) Coordinate Reference System.
If the survey fixed point coordinates have been transformed into another reference system,
the transformed coordinates are used to reference the model and the DEM data must be
in that model.
If the survey has only long-lat (WGS84) coordinates, the WGS-84 system is used.<br>
The DEM extent must cover the area of the model.<br><p>

The transparency of the surface is adjustable. If fully opaque the portions of surface behind others are hidden.<br>
The projection of the survey centerline on the surface can be displayed (blue).<br>
When the model has a surface, it can be colored by the depth beneath the surface.
<br><p>

If the model has a surface DEM, the surface texture can be loaded from a file.
The supported file formats are GeoTiff and OSM.<br>
The GeoTiff file must be in the same Cartographic Coordinate Reference System of the survey.
[Tech note: if the file is 24-bit non-compressed or uses a colormap Cave3D tries to read only the portion
covering the DEM area, otherwise the whole image
is read in and portion area is extracted.]<br>
The OSM texture (WGS84) can be loaded only for surveys and cave projects opened from TopoDroid.
The texture displays the OSM lines.
<br><p>

It is possible to visualize a point (yellow dot) on the surface by entering the East/North coordinates in the CRS of the model.<br>

Models loaded from TopoDroid can get also GNSS points.
If the app has permission to use the "Location" service, and this service is enabled, it is possible to
get surface point with the Android GNSS.<br>
given permissions to use it.<br>
The app displays the last 10 points.
<br><p> 

<b>STATION ACTIONS</b><br>
By default, when the stations are displayed, they can be selected tapping on the station point or name.<br>
Station selection can be turned on/off with a long tap on the "station" button. When the stations are selectable
the button has a red dot.<br><p>

The selected station is highlighted red, and its coordinates are shown in a blue bar at the bottom.
If the model has a DEM, the depth of the station below the surface is included.<br>
To unselect the station tap on the station again or on the bar.<br><p>

To measure distances between the selected station and another station, check the "measure" button in the bottom bar,
and tap on the other station.
The 3D distance between the two stations, its East, North, and vertical components, and the plane 2D distance are
displayed in a dialog.
If the two stations are connected along the centerline the "cave" distance is also shown
and the cave-path between them is highlighted green.<br>
Optionally, the values can be displayed in a brief message box instead of a dialog.  <br><p>

When the "station" button in the bottom bar is checked, the station position on the screen 
if fixed under rotations and the
selected station is highlighted orange.
<br><p>

<b>SKETCH LIFTING</b> (Experimental)<br>
With surveys and cave-projects opened from TopoDroid it is possible to "lift" 2D sketches to the 3D model.
The sketch must be exported (in TopoDroid) in "Cave3D" format. The exported file is in the "c3d" folder
of TopoDroid. Next a sketch file can be loaded from the 3D viewer, and the sketch is lifted to adapt to the
3D model.<br>

The sketch dialog displays the list of opened sketches.<br>
Each item has two checkboxes: the first to switch on/off
the display of the sketch, the second to remove the sketch. The choices must be confirmed with the "OK" button.<br>
There is a button to load a new sketch.<br>
Finally there is a button to rebind the point icons, if they go black.
<br><p>


<a href="manual14.htm">&lt; Cave Projects</a> |
<a href="manual16.htm">Index &gt;</a> 

</body></html>
