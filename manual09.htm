<html><body>
<h3>[9] SKETCH WINDOW</h3>

The <i>sketch</i> button of the <u>data window</u> opens the dialog with the list of sketches, besides the <i>New Sketch</i> button. Tap on this button to create a new survey sketch.<br><p>

Each sketch is made of two sketch files: one for the plan view, the other for the profile view (either extended or projected). X-sections have only one file. A new sketch is opened in the plan view. Afterwards the sketch dialog shows two columns, one for the plan, the other for the profile view, and you can choose which one to open from.<br>
Each sketch can contain multiple scraps.<br><p>

The <u>extended</u> profile view displays the midline with the shots drawn left or right, or vertical, according to their "extend". If a leg has the "extend" not set, the midline is not displayed from that leg on.
Splays are projected on the vertical plane of the shot that is closest in azimuth, unless the user has set a given "extend" through the shot edit dialog.
For example, for the plan view in figure, the splays in the light region are projected on the vertical plane of shot 1-2, those in the dark region on the vertical plane of 0-1.<br><p>  

The <u>projected</u> profile view displays the midline and the splays projected in the vertical plane perpendicular to the projection azimuth.<br><p>


<img src="splay_extend.png"><br><p>

<b>Legs</b><br>

The leg colors are 
<ul>
<li>normal: white</li>
<li>anomalous field values: red</li>
<li>inconsistent with siblings: orange. These are also drawn with a zig-zag line as shown below.</li>
</ul><br>

<img src="line_zigzag.png"><br><p>

<b>Splays</b><br>

Splays can be displayed as segments or as endpoint dots [G].
When the window is in selection mode, the splays are always displayed as segments.<br>

The splay colors are [E/G]
<ul>
<li>commented: dark green</li>
<li>x-splay (LRUD): green</li>
<li>h-splay: deep blue (plan), dark blue (profile)</li>
<li>v-splay: dark blue (plan), deep blue (profile)</li>
<li>others: light grey</li>
</ul><br><p>

It is possible to set the splay transparency (opacity level) [G].<br>
Splays can be assigned different colors, individually or in groups (with multi-editing).
The colors for splays can be chosen among a palette of colors or with a color picker [G].<br>
A splay is not shown if the shot is marked for no-display in plan or profile view.<br><p>

If splay dashing [G] is not disabled, they can be displayed with a dashed or a dotted line.<br>
If the splay-dashing is set to <i>azimuth</i> the splay is dashed if the 
angle with the "closest" leg in azimuth is above the dash azimuth-threshold, [default 60&deg;]<br>
If the splay-dashing is set to <i>clino</i> the splay is dashed if the 
splay clino is above the dash clino-threshold: dotted (positive clino) and dashed (negative clino).<br>
If the splay-dashing is set <i>by the view</i> the splays dashed by the clino in the plan view and
by the azimuth in the extended profile view. In the projected profile the splays are dashed according to the 
angle they form with the direction of projection.<br><p>

Furthermore, in the <u>plan</u> view the splay is not displayed 
if the inclination of the splay is over the plan-view threshold [default 80&deg;]<br>

For <u>x-sections</u>:
<ul>
<li>x-splays (LRUD) are green</li>
<li>other splays are blue: dark at TO station, light at FROM station</li>
<li>finally, if splay-dashing is enabled, they are dotted or dashed
if the angle between the splay and the normal to the x-section plane is below the dash angle-threshold
[default 60&deg;] (dotted if in the direction of the normal, dashed if opposite).</li>
</ul><br>

The colors of dashed and dotted splay line can be changed with appropriate settings [G].<br><p>

<b>Stations</b><br>
The station colors are
<ul>
<li>violet: default</li>
<li>green: active station</li>
<li>red: stations beyond which the midline is hidden</li>
<li>blue: stations before which the midline is hidden</li>
<li>yellow: saved stations [T/G]</li>
</ul><br><p>

<b>Interaction modes</b><br>
The <u>sketch window</u> has four interaction modes:
<ul style="margin-top=0">
<li><b>move</b>: you can shift the canvas, and zoom in/out. If the "fixed references" box in the references dialog is set, shifts affect only the drawings [T]</li>
<li><b>draw</b>: in this mode you add iconic symbols (points, including labels), and trace lines and areas (closed regions filled with a color or a pattern).</li>
<li><b>erase</b>: to erase items, and lines/areas, or portions of them, from the sketch.</li>
<li><b>edit</b> [A]: for point-wise changes and item properties editing, including item deleting.</li>
</ul><br><p>

Shift and zoom are possible even in <b>draw</b> and in <b>erase</b> mode using two fingers.
If "corner-drag" is enabled, the sketch can be shifted by "dragging" it from the corners of the canvas.
Corners are displayed as transparent gray.<br>
Zoom controls can be enabled (either temporarily or permanently). If temporary, they show up when you tap at the bottom
of the canvas in the middle.<br>
In "draw mode" there is a bottom toolbar with the most recently used tools, and an "arrow" button to select other tools.<br>
In "edit mode", when the selected item is a point, there is a bottom slider for point scale. If "corner-drag" is enabled,
and the point item is orientable, its orientation can be rotated clockwise by dragging down from the top-right corner, and
counterclockwise by dragging down from the top-left corner.<br><p>


<h4>BUTTONS</h4>
The modes are represented by the three green buttons on the left: <i>draw</i>, <i>erase</i>, and <i>edit</i>. When one of them is "on" the relative button has a bright green color. If none is on the mode is <i>move</i>.<br><p>

When a green button is "on", a long tap on it, opens the dialog to edit the settings relevant to the mode of the button.<br><p>

<img src = "btn_edit.png" height="36" border="1"><img src = "btn_erase.png" height="36" border="1"><img src = "btn_select.png" height="36" border="1">
<br clear=all>

The remaining buttons differ by the mode.<br><p>
In the <b>move</b> mode they are:
<ul style="margin-top=0">
<li><img src="btn_download.png" width="36" border="1"> data <i>download</i>.  If no device is selected, this button is hidden.
By default splays and legs are refreshed when a leg is downloaded (and identified). 
Use the refresh button to force a centerline refresh.
The last download shots can be highlighted blue to help distinguish them from the others [G].
</li>
<li><img src="btn_bluetooth.png" width="36" border="1"> <a href="page_bluetooth.htm">Bluetooth</a> reset/controls</li>
<li><img src="btn_note.png"      width="36" border="1"> survey <a href="page_survey_notes.htm">notes</a></li>
<li><img src="btn_mode.png"      width="36" border="1"> drawing <a href="page_drawing_refs.htm">references</a>: legs, splays, stations, metric grid, scalebar, and sketch outline.</li>
<li><img src="btn_plan.png"      width="36" border="1"> <i>plan/profile</i> switch. <img src = "btn_splay_group.png" width="36" border="1"> <i>Splay-display mode</i>, for x-sections</li>
<li><img src="btn_azimuth.png"   width="36" border="1"> <a href="page_azimuth.htm">"extend" reference</a></li>
<li><img src="btn_refresh.png"   width="36" border="1"> refresh the centerline</li>
</ul><br><p>

The <b>draw</b> mode has four buttons besides the green ones:
<ul style="margin-top=0">
<li><img src="btn_undo.png"  width="36" border="1"> removes the last items you have drawn, one at a time.</li>
<li><img src="btn_redo.png"  width="36" border="1"> puts the removed item back in the sketch, one at a time. The list of removed items is emptied when you draw something new. Point-wise editing actions may also affect the list of redo.</li>
<li><img src="btn_tools.png" width="36" border="1"> <a href="page_tools_list.htm">Drawing tool</a> switcher / picker.</li>
<li>splay display mode: as segment or a border="1"s point.</li>
<li><img src="btn_cont.png"  width="36" border="1"> Line <i>joining</i> or continuing</li>
</ul><br><p>
The icon of the <i>tools</i> button reflects the current type of drawing tools: points, lines, or areas.<br><p>

The <b>erase</b> mode has three buttons besides the green ones:
<ul style="margin-top=0">
<li><img src="btn_undo.png"  width="36" border="1"> <i>undo</i></li>
<li><img src="btn_redo.png"  width="36" border="1"> <i>redo</i></li>
<li><img src="btn_erase_all.png" width="36" border="1"> type of erasable items: all, points, lines, areas</li>
<li><img src="btn_size.png"  width="36" border="1"> eraser size [S, M, L]</li>
</ul><br><p>

The <b>edit</b> [A] mode has, besides the green buttons:
<ul style="margin-top=0">
<li><img src="btn_select_all.png" width="36" border="1"> type of selectable items: all, points, lines, areas, shots, stations</li>
<li><img src="btn_size.png"   width="36" border="1"> size of the selection tool [S, M, L]</li>
<li><img src="btn_delete.png" width="36" border="1"> delete the item from the sketch (it asks for confirmation, and can be "undone").</li>
<li><img src="btn_point.png"  width="36" border="1"> point-wise and special actions</li>
<li><img src="btn_item.png"   width="36" border="1"> item properties edit</li>
<li><img src="btn_range.png"  width="36" border="1"> range selection: either point-wise or local (only for lines and areas).</li>
</ul><br><p>
When there are selected items the first two buttons become <i>previous/next</i> navigation buttons in the set
of the selected items.<br><p>

The buttons are somewhat different for x-section sketches.
In the <b>move</b> mode the buttons "switch", "azimuth", and "refresh" are not shown, but there
is a button to select which splay to show. It cycles through four states: "both", "viewed station", "behind station", "none".
Accordingly, the drawing references dialog has no box for the splays.
<br><p>

<b>Long tap actions</b><br>
<ul style="margin-top=0">
<li>A long tap on each <i>mode</i> button opens the relevant settings dialog [A].</li>
<li>The <i>download</i> button switches the device, in multi device mode [E].</li>
<li>In plan view, a long tap on the <i>extend reference</i> button makes the reference azimuth 
graphically editable by sliding the finger across the display.  The button turns green [E].</li>
<li>In the extended profile view, a long tap on the <i>display mode</i> button flips the sketch [N].</li>
<li>With x-sections it toggles the display of splays that are off the section plane [T].</li>
<li>A long tap on the <i>tools</i> button reverts the order of rotation of the bottom toolbar.<!-- Ineffective for the triple toolbar. --></li>
<li>A long tap on the <i>delete</i> button removes the selected line/area point [N].</li>
<li>A long tap on the item <i>properties edit</i> button, when the selected item is a section point, opens the xsection sketch [T].</li>
</ul><br><p>


<h4>MENUS</h4>
When anomalies have been detected in the survey data-reduction, the "menu" button (three dots in vertical) has a red exclamation mark.
Long-tap on the button to display a dialog about the anomalies.<br><p>

<ul style="margin-top=0">
<li><u>Switch</u> to another sketch or <u>close</u>.</li>
<li><u>Export</u>: the sketch can be <a href="page_plot_export.htm">exported</a> as <i>Therion</i> th2, <i>cSurvey</i>, DXF,
SVG, PDF, xvi (<i>xtherion</i>), shapefile (<i>QGIS</i>), and <i>Tunnel</i>.
All exports generate two files, one for plan the other for profile, except <i>cSurvey</i>, which has both in one file.</li>
<li><a href="page_stat2.htm">Statistics</a>. For x-sections this computes the section area.</li>
<li><u>Reload</u> the sketch from a <a href="page_backup.htm">backup copy</a>.</li>
<li><u>Zoom-fit</u>: dialog to fit the sketch into the screen, and to select the portrait or landscape presentation</li>
<li><u>Rename/Delete/Split</u> the sketch. Renaming and deleting affects both plan and profile view at the same time. Deleted sketches can be recovered (<i>recover</i> menu in <u>data window</u>). Splitting affects only the current view.</li>
<li><a href="page_plot_scraps.htm">Scraps</a> dialog [T]</li>
<li><a href="page_tools.htm">drawing tools</a> palette</li>
<li><u>Overview window</u>, showing all the survey sketches together. [Only for plan and extended profiles]</li>
<li><u>Settings</u></li>
<li><u>Help</u></li>
</ul><br><p>


<h4>SKETCH SETTINGS</h4>
<ul style="margin-top=0">
  <!-- li><i>Drawing tool picker</i>: list, grid, or triple-grid view [default: list]</li -->
  <!-- li><i>Bottom toolbar</i>: single or triple [default: single]</li -->
  <li><i>Corner drag</i>: enable panning by corner-drag</li>
  <li><i>Zoom controls</i>: specifies how zoom controls are displayed on multitouch devices [B]. The zoom controls can be hidden, displayed only for a short interval when the user tap the lower part of the screen in the middle, or shown all the time</li>
  <li><i>Horizontal x-sections</i> leg-clino threshold for horizontal x-sections (profile view).</li>
  <li><i>Midline check</i>: check if all the legs are attached to the midline [disabled]</li>
  <li><i>Extend check</i>: check if all the legs have the "extend" defined [enabled]</li>
  <!-- li><i>xtherion areas</i> save sketch th2 files with an extra point in area borders</li -->
  <li><i>POINT TOOLS</i>
    <ul style="margin-top:0; margin-bottom:0">
    <li><i>Non-zoomed point</i>: point items stay of fixed size when zooming</li>
    <li><i>Drawing units</i> for point symbols</li>
    <li>Label <i>text size</i> [24 pt]</li>
    </ul>
  <li><i>LINE TOOLS</i>
    <ul style="margin-top:0; margin-bottom:0">
    <li>Line <i>pen width</i> (NB wall-lines are twice as wide) [1 px]</li>
    <li><i>Drawing units</i> for lines with "path effect"</li>
    <li>Line <i>style</i>: fine, normal, coarse, "splines" (interpolated-curve), simplified</li>
    <li>Line <i>point spacing</i>: distance between line points in normal style [5 px] </li>
    <li><i>Direction tick length</i> for x-section lines [5 px]</li>
    <li><i>Section points</i>: whether to add a "section" point automatically for "section" lines [default yes]</li>
    <li>Line <i>default join mode</i>: none, start, end, both, "continue"</li>
    <li>Area <i>border</i> default visibility</li>
    </ul>
  </li>
  <li><i>SKETCH ITEMS</i>
    <ul style="margin-top:0; margin-bottom:0">
    <li>Survey line <i>pen width</i> (midline/splay)</li>
    <li>Station name <i>text size</i> [18 pt] [N]</li>
    <li>Size of <i>green dots</i> displayed in <b>edit</b> mode [5 px] [A]</li>
    <li><i>Selection</i> radius for fine-editing a sketch; [16 px] [A]</li>
    <li>Base size of the <i>eraser</i></li>
    <li><i>Shift sensitivity</i>: maximum stepping when moving a sketch [60 px] [E]. Increase it if sketch shifting is jaggy</li>
    <li>Radius of <i>pointing</i>: to select you must not move the finger more than this [A]</li>
    <li><i>Splay transparency</i>: opacity level [0: transparent, 100: opaque, default 80]</li>
    <!--
    <li><i>Splay plan-view threshold</i>: splay shots with inclination above this threshold are hidden in the plan-view [80&deg;]</li>
    <li><i>X-section H-threshold</i>: the inclination angle above which a x-section is horizontal. (Below it x-section are vertical).</li>
    -->
    </ul>
  </li>
</ul><br><p>

<div style="font-size:90%">
<a href="page_geek.htm">Custom settings</a>:
<i>sketch shift/scale</i>, 
<i>sketch split/merge</i>,
<i>Leg vertical threshold (over threshold LRUD become WENS)</i>,
<i>saved stations coloring</i>,
<i>minimum angle of corners when a line is straightened</i>
<i>Bezier interpolation accuracy, and corner threshold</i>,
<i>Line simplification distance, length, and buffer zone</i>,
<i>Point-wise actions flags (Line/Area snap, Smooth/Straighten segment, Multiselection, Composite actions)</i>,
<i>Splay dashing (mode, clino threshold, azimuth thresholds)</i>,
<i>Backup number and interval</i>,
<i>Backup clearing menu</i>,
<i>auto x-section in exports (csx, svg, dxf, xvi)</i>
<i>Auto-walls settings</i>.
</div><br><p>

<h4>Sketch cache</h4>
Once opened the sketches are kept in memory, in a cache. This speeds up switching between the <u>data window</u>
and the <u>sketch window</u>, as the sketch do not need to be read from file.
The sketch cache is cleared when the survey is closed.<br><p>

<h4>Sketch file format</h4>
Each sketch is saved to file whenever it is modified, or when the <u>sketch window</u> changes to a different view.
For performance TopoDroid saves the sketches in a binary format.<br><p>

<h4>Point selection [A]</h4>
To do some editing you must select a point: either a point item, a line/area point, a station, or a shot midpoint.<br>
To this aim you tap near the point you want. However if there are several points close where you tap, they are all selected, but only one of them is being edited. You change the "edit" point among the selected set with the <i>previous/next</i> buttons.<br><p>

<h4>Line style</h4>
TopoDroid has five line styles. With the normal style [default] the lines are drawn as polylines. With the fine style the polyline segments are shorter, while with the coarse style they are longer. In the fourth style lines are interpolated replacing the segments with cubic Bezier curves (splines). These segments pass through the two endpoints and have two control points used define the curvature.
With the fifth line style the traced lines are simplified using a point-weeding algorithm.
If you export the drawing in dxf with DXF version 6 do not use splines because they get exported as polylines.<br><p>

<h4>Line joining</h4>
The <i>join</i> button is a multi-state button.
Line joining can be done only with other lines of the scraps.
The lines that are joined must belong to the same group. If you need to "join" two points of lines of different groups
you should move one point to coincide with the other.<br>
<ul>
<li><i>off</i>: the lines of the current type cannot be joined</li>
<li><i>no</i>: the current type line will not be joined</li>
<li><i>start</i>: the current type line will be joined to a line if its start-point is close to one of that line endpoints</li>
<li><i>end</i>: the current type line will be joined to a line by its end-point</li>
<li><i>both</i>: the current type line will be joined to a line by both its start and its end-point</li>
<li><i>continue</i>: the current type line will continue a line if its start-point is close enough to an endpoint of that line</li>
</ul>
<br>

When the joining is set to "continue" the last line that has been drawn can be <i>modified</i> as in Adobe Illustrator, ie,
retracing a piece of the line from the start point.<br>
"Continue" affects the undo-stack, because the continued line can be moved to the top of the stack.
<br><p>

<div style="font-size:90%">
<h4>Composite actions [T]</h4>
Composite actions are point-wise long-tap actions.<br>
At the moment the only long-tap action is to <i>insert a point</i> for a line/area and snap it to a nearby point at the same time.
The selected point is first moved to the nearby point, next it is duplicated and the new point is put after it in the line/area.
This allows to retrace a path by selecting the last point and inserting points backwards.<br>
To retrace the path forward switch the selected point after each insertion.
</div><br><p> 

<h4>Portrait/Landscape presentation</h4>
In portrait presentation the magnetic North and the Vertical are upward in plan and profile view, respectively.
If the survey declination is set the true North is shown as an angle to the magnetic North.<br>
In landscape presentation they are leftward so that the East is upward in plan view and the Right is upward in profile view.<br>
In landscape presentation the iconic symbols are rotated so that they appear natural holding the device in portrait mode.<br><p>

The sketches are always saved and exported with the magnetic North and the vertical upward.<br><p>
 
<b>Warning. If the sketch disappear from the display, switch between plan and profile to force TopoDroid to refresh it.</b><br><p>


<h4>File editor mode</h4>
The <i>sketch window</i> is opened in file editing mode from the "sketch" button of the <i>Main window</i>.
TopoDroid sketch ".tdr" files and (simple) Therion '.th2" files can be loaded and edited.
The changes are not saved and the sketch must be exported to save them.<br><p>

TopoDroid ".tdr" files are not related to a survey. The stations are loaded from the file as "user station" points.<br><p>

The syntax of Therion ".th2" files is not fully supported. 
In particular areas with multiline border are not supported, because TopoDroid has only single-line border areas.<br><p>

When the <i>sketch window</i> is opened as editor, the buttons and the menus change.
The menus are:<br>
<ul>
<li><i>Close</i> the window</li>
<li><i>Save</i> the th2 file with the modifications</li>
<li><i>Open</i> a th2 file</li>
<li><i>Zoom fit</i></li>
<li><i>Scraps</i></li>
<li><i>Palette</i></li>
<li><i>Settings</i></li>
<li><i>Help</i></li>
</ul><br><p>

In <i>move</i> mode there are only the three green buttons for the other modes.<br>
The <i>draw</i> mode has the buttons: <i>undo</i>, <i>redo</i>, <i>tools</i>, and <i>line continuation</i>.<br>
The <i>erase</i> and <i>edit</i> modes have the usual buttons.<br><p>

The th2 file can contain more than one scrap.
As the sketch is not tied to a survey, there is no midline reference, ie, no legs and no splays.
Stations are present only if the th2 file contains "station" points. 
In this case they are displayed as dots with the station name nearby.<br><p>

The metric grid is displayed only when a graph-paper size is set (through the <i>zoom-fit</i> dialog).<br><p>



<a href="page_tools.htm">Drawing tools palette</a><br>
<a href="page_therion_stations.htm">Therion station points</a><br>
<a href="page_undo.htm">Undo stack</a><br>
<a href="page_shift.htm">Sketch shift and flip</a><br>
<p>

<a href="manual08.htm">&lt; Survey info</a> |
<a href="manual10.htm">Sketch drawing &gt;</a>

</body></html>
